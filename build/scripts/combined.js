function addCommas(e){e+="";for(var t=e.split("."),s=t[0],r=t.length>1?"."+t[1]:"",o=/(\d+)(\d{3})/;o.test(s);)s=s.replace(o,"$1,$2");return s+r}var allLayers=[{groupHeading:"some layers",showGroupHeading:!0,includeInLayerList:!0,layers:{}},{groupHeading:"some other layers",showGroupHeading:!0,includeInLayerList:!0,layers:{"Pt Feature Layer":{url:"http://wim.usgs.gov/arcgis/rest/services/BadRiverDataPortal/NWIS_Sites/MapServer/0",options:{id:"ptFeatureLayer",visible:!0},wimOptions:{type:"layer",layerType:"agisFeature",includeInLayerList:!0}},"FIM Sites":{url:"http://fimlb-1071089098.us-east-1.elb.amazonaws.com/arcgis/rest/services/FIMMapper/sites/MapServer/0",options:{opacity:.75,visible:!0},wimOptions:{type:"layer",layerType:"agisFeature",includeInLayerList:!0}}}},{groupHeading:"exclusive group",showGroupHeading:!0,includeInLayerList:!0,layers:{"Cat 2":{url:"http://olga.er.usgs.gov/stpgis/rest/services/Vulnerability/NACCH_change_probabilities/MapServer",options:{id:"cat2",layers:[13,14,15],opacity:1},wimOptions:{type:"layer",layerType:"agisDynamic",includeInLayerList:!0,exclusiveGroupName:"Coastal Erosion Hazard",visible:!1}},"Cat 1":{url:"http://olga.er.usgs.gov/stpgis/rest/services/Vulnerability/NACCH_change_probabilities/MapServer",options:{id:"cat1",layers:[5,6,7],opacity:1},wimOptions:{type:"layer",layerType:"agisDynamic",includeInLayerList:!0,exclusiveGroupName:"Coastal Erosion Hazard",visible:!0}}}},{groupHeading:"other map servers",showGroupHeading:!0,includeInLayerList:!0,layers:{Wetlands:{url:"http://107.20.228.18/ArcGIS/rest/services/Wetlands/MapServer",options:{opacity:.75,visible:!0},wimOptions:{type:"layer",layerType:"agisDynamic",includeInLayerList:!0,zoomScale:144448}},"NAWQA networks":{url:"http://wimsharedlb-418672833.us-east-1.elb.amazonaws.com/arcgis/rest/services/NAWQA/tablesTest/MapServer",options:{layers:[1],visible:!0,opacity:.6},wimOptions:{type:"layer",layerType:"agisDynamic",includeInLayerList:!0}}}}],stnServicesURL="http://stn.wim.usgs.gov/STNServices",stnServicesTestURL="http://stntest.wim.usgs.gov/STNServices2",fev=fev||{data:{events:[],eventTypes:[],states:[],counties:[],sensorTypes:[],sensorStatusTypes:[],collectionConditions:[],deploymentTypes:[],hwmTypes:[],hwmQualities:[]},urls:{jsonSensorsURLRoot:stnServicesURL+"/Instruments.json",xmlSensorsURLRoot:stnServicesURL+"/Instruments.xml",csvSensorsURLRoot:stnServicesURL+"/Instruments.csv",jsonHWMsURLRoot:stnServicesURL+"/HWMs/FilteredHWMs.json",xmlHWMsURLRoot:stnServicesURL+"/HWMs/FilteredHWMs.xml",csvHWMsURLRoot:stnServicesURL+"/HWMs/FilteredHWMs.csv",xmlPeaksURLRoot:stnServicesURL+"/PeakSummaries/FilteredPeaks.xml",jsonPeaksURLRoot:stnServicesURL+"/PeakSummaries/FilteredPeaks.json",csvPeaksURLRoot:stnServicesURL+"/PeakSummaries/FilteredPeaks.csv",baroGeoJSONViewURL:stnServicesURL+"/SensorViews.geojson?ViewType=baro_view&",metGeoJSONViewURL:stnServicesURL+"/SensorViews.geojson?ViewType=met_view&",rdgGeoJSONViewURL:stnServicesURL+"/SensorViews.geojson?ViewType=rdg_view&",stormTideGeoJSONViewURL:stnServicesURL+"/SensorViews.geojson?ViewType=stormtide_view&",waveHeightGeoJSONViewURL:stnServicesURL+"/SensorViews.geojson?ViewType=waveheight_view&",hwmFilteredGeoJSONViewURL:stnServicesURL+"/HWMs/FilteredHWMs.geojson",hwmGeoJSONViewURL:stnServicesURL+"/hwms.geojson"},queryStrings:{}},map,layerGroup,oms,markerCoords=[],baroMarkerIcon=L.divIcon({className:"baroMarker",iconAnchor:[8,24],popupAnchor:[0,-10]}),metMarkerIcon=L.divIcon({className:"metMarker",iconAnchor:[8,24],popupAnchor:[0,-10]}),rdgMarkerIcon=L.divIcon({className:"rdgMarker",iconAnchor:[8,24],popupAnchor:[0,-10]}),stormTideMarkerIcon=L.divIcon({className:"stormTideMarker",iconAnchor:[8,24],popupAnchor:[0,-10]}),waveHeightMarkerIcon=L.divIcon({className:"waveHeightMarker",iconAnchor:[8,24],popupAnchor:[0,-10]}),hwmMarkerIcon=L.divIcon({className:"hwmMarker",iconAnchor:[8,24],popupAnchor:[0,-10]}),peaksMarkerIcon=L.divIcon({className:"hwmMarker",iconAnchor:[8,24],popupAnchor:[0,-10]}),sensorMCG=L.markerClusterGroup({disableClusteringAtZoom:8,spiderfyOnMaxZoom:!1,zoomToBoundsOnClick:!0}),baro=L.featureGroup.subGroup(sensorMCG),stormTide=L.featureGroup.subGroup(sensorMCG),met=L.featureGroup.subGroup(sensorMCG),rdg=L.featureGroup.subGroup(sensorMCG),waveHeight=L.featureGroup.subGroup(sensorMCG),hwmMCG=L.markerClusterGroup({disableClusteringAtZoom:8,spiderfyOnMaxZoom:!1,zoomToBoundsOnClick:!0,iconCreateFunction:function(e){return L.divIcon({html:'<div style="display: inline-block"><span style="display: inline-block" class="hwmClusterText">'+e.getChildCount()+"</span></div>",className:"hwmClusterMarker"})}}),hwm=L.featureGroup.subGroup(hwmMCG);$(document).ready(function(){"use strict";function displaySensorGeoJSON(type,url,markerIcon){var currentSubGroup=eval(type),currentMarker=L.geoJson(!1,{pointToLayer:function(e,t){var s=L.marker(t,{icon:markerIcon});return s},onEachFeature:function(e,t){oms.addMarker(t);var s="";$.each(e.properties,function(e,t){t&&"undefined"!=t&&(s+="<b>"+e+"</b>:&nbsp;&nbsp;"+t+"</br>")}),t.bindPopup(s)}});$.getJSON(url,function(e){console.log(e.features.length+" "+markerIcon.options.className+" GeoJSON features found"),currentMarker.addData(e),currentMarker.eachLayer(function(e){e.addTo(currentSubGroup)})})}function displayHWMGeoJSON(e,t){var s=L.geoJson(!1,{pointToLayer:function(e,s){var r=L.marker(s,{icon:t});return r},onEachFeature:function(e,t){oms.addMarker(t);var s="";$.each(e.properties,function(e,t){t&&"undefined"!=t&&(s+="<b>"+e+"</b>:&nbsp;&nbsp;"+t+"</br>")}),t.bindPopup(s)}});$.getJSON(e,function(e){console.log(e.features.length+" "+t.options.className+" GeoJSON features found"),s.addData(e),s.eachLayer(function(e){e.addTo(hwm)})})}function showGeosearchModal(){$("#geosearchModal").modal("show")}function showAboutModal(){$("#aboutModal").modal("show")}function showFiltersModal(){$("#filtersModal").modal("show")}function setBasemap(e){layer&&map.removeLayer(layer),layer=L.esri.basemapLayer(e),map.addLayer(layer),layerLabels&&map.removeLayer(layerLabels),("ShadedRelief"===e||"Oceans"===e||"Gray"===e||"DarkGray"===e||"Imagery"===e||"Terrain"===e)&&(layerLabels=L.esri.basemapLayer(e+"Labels"),map.addLayer(layerLabels))}function setSearchAPI(){search_api.on("load",function(){$("#chkExtent").change(function(){if($(this).is(":checked")){console.log("Checked",map.getBounds().getSouth(),map.getBounds().getNorth(),map.getBounds().getWest(),map.getBounds().getEast());var e=map.getBounds();search_api.setOpts({LATmin:e.getSouth(),LATmax:e.getNorth(),LONmin:e.getWest(),LONmax:e.getEast()})}}),search_api.setOpts({textboxPosition:"user-defined",theme:"user-defined",DbSearchIncludeUsgsSiteSW:!0,DbSearchIncludeUsgsSiteGW:!0,DbSearchIncludeUsgsSiteSP:!0,DbSearchIncludeUsgsSiteAT:!0,DbSearchIncludeUsgsSiteOT:!0}),search_api.on("location-found",function(e){var t=14;"U.S. State or Territory"===e.Category&&(t=9),map.setView([e.y,e.x],t),L.popup().setLatLng([e.y,e.x]).setContent("<p><b>"+e.label+"</b> <br/><br/><b>NAME:            </b> "+e.name+"<br/><b>CATEGORY:        </b> "+e.category+"<br/><b>STATE:           </b> "+e.state+"<br/><b>COUNTY:          </b> "+e.county+"<br/><br/><b>LATITUDE:        </b> "+e.y+"<br/><b>LONGITUDE:       </b> "+e.x+"<br/><b>ELEVATION (FEET):</b> "+e.elevFt+"<br/><br/><b>PERCENT MATCH:   </b> "+e.pctMatch+"<br/></p>").openOn(map)}),search_api.on("no-result",function(){console.error("No location matching the entered text could be found.")}),search_api.on("timeout",function(){console.error("The search operation timed out.")})}),$("#searchSubmit").on("click",function(){console.log("in search submit"),$("#sapi-searchTextBox").keyup()})}function scaleLookup(e){switch(e){case 19:return"1,128";case 18:return"2,256";case 17:return"4,513";case 16:return"9,027";case 15:return"18,055";case 14:return"36,111";case 13:return"72,223";case 12:return"144,447";case 11:return"288,895";case 10:return"577,790";case 9:return"1,155,581";case 8:return"2,311,162";case 7:return"4,622,324";case 6:return"9,244,649";case 5:return"18,489,298";case 4:return"36,978,596";case 3:return"73,957,193";case 2:return"147,914,387";case 1:return"295,828,775";case 0:return"591,657,550"}}map=L.map("mapDiv").setView([39.833333,-98.583333],4);var layer=L.esri.basemapLayer("Gray").addTo(map),layerLabels;sensorMCG.addTo(map),baro.addTo(map),stormTide.addTo(map),met.addTo(map),rdg.addTo(map),waveHeight.addTo(map),hwmMCG.addTo(map),hwm.addTo(map);var sensorOverlays={"<i class='baroMarker'></i>&nbsp;Barometric Pressure Sensor":baro,"<i class='metMarker'></i>&nbsp;Meteorological Sensor":met,"<i class='rdgMarker'></i>&nbsp;Rapid Deployment Gage":rdg,"<i class='stormTideMarker'></i>&nbsp;Storm Tide Sensor":stormTide,"<i class='waveHeightMarker'></i>&nbsp;Wave Height Sensor":waveHeight},sensorsToggle=L.control.layers(null,sensorOverlays,{collapsed:!1});sensorsToggle.addTo(map),sensorsToggle._container.remove(),document.getElementById("sensorsToggleDiv").appendChild(sensorsToggle.onAdd(map));var observedOverlay={"<i class='hwmMarker'></i>&nbsp;High Water Marks":hwm},observedToggle=L.control.layers(null,observedOverlay,{collapsed:!1});observedToggle.addTo(map),observedToggle._container.remove(),document.getElementById("observedToggleDiv").appendChild(observedToggle.onAdd(map)),oms=new OverlappingMarkerSpiderfier(map,{keepSpiderfied:!0}),$.each(["baro","met","rdg","stormTide","waveHeight"],function(e,t){displaySensorGeoJSON(t,fev.urls[t+"GeoJSONViewURL"],window[t+"MarkerIcon"])}),$.each(["hwm"],function(e,t){displayHWMGeoJSON(fev.urls[t+"GeoJSONViewURL"],window[t+"MarkerIcon"])}),$("#sensorDownloadButtonCSV").attr("href",fev.urls.csvSensorsURLRoot),$("#sensorDownloadButtonJSON").attr("href",fev.urls.jsonSensorsURLRoot),$("#sensorDownloadButtonXML").attr("href",fev.urls.xmlSensorsURLRoot),$("#hwmDownloadButtonCSV").attr("href",fev.urls.csvHWMsURLRoot),$("#hwmDownloadButtonJSON").attr("href",fev.urls.jsonHWMsURLRoot),$("#hwmDownloadButtonXML").attr("href",fev.urls.xmlHWMsURLRoot),$("#peaksDownloadButtonCSV").attr("href",fev.urls.csvPeaksURLRoot),$("#peaksDownloadButtonJSON").attr("href",fev.urls.jsonPeaksURLRoot),$("#peaksDownloadButtonXML").attr("href",fev.urls.xmlPeaksURLRoot),$(".dataTypeRadio").each(function(){$(this).on("click",function(){var e=$(this).attr("id"),t=$("#"+e+"Form");t.show(),$(".hiddenForm").not(t).hide()})}),$(".check").on("click",function(){$(this).find("span").toggle()}),$("#geosearchNav").click(function(){showGeosearchModal()}),$("#aboutNav").click(function(){showAboutModal()}),$("#btnFilters").click(function(){showFiltersModal()}),$("#btnFilter").on("click",function(){buildQueryStrings()}),$(".basemapBtn").on("click",function(){var e=this.id.replace("btn","");switch(e){case"Streets":e="Streets";break;case"Satellite":e="Imagery";break;case"Topo":e="Topographic";break;case"Terrain":e="ShadedRelief";break;case"Gray":e="Gray";break;case"NatGeo":e="NationalGeographic"}setBasemap(e)});var searchScript=document.createElement("script");searchScript.src="http://txpub.usgs.gov/DSS/search_api/1.1/api/search_api.min.js",searchScript.onload=function(){setSearchAPI()},document.body.appendChild(searchScript),$("#legendButtonNavBar, #legendButtonSidebar").on("click",function(){$("#legend").toggle()}),$("#legendClose").on("click",function(){$("#legend").hide()}),map.whenReady(function(){var e=scaleLookup(map.getZoom());$("#scale")[0].innerHTML=e,console.log("Initial Map scale registered as "+e,map.getZoom());var t=map.getCenter();$("#latitude").html(t.lat.toFixed(4)),$("#longitude").html(t.lng.toFixed(4))}),map.on("zoomend",function(){var e=map.getZoom(),t=scaleLookup(e);$("#scale")[0].innerHTML=t}),map.on("mousemove",function(e){$("#mapCenterLabel").css("display","none"),null!==e.latlng&&($("#latitude").html(e.latlng.lat.toFixed(4)),$("#longitude").html(e.latlng.lng.toFixed(4)))}),map.on("dragend",function(){$("#mapCenterLabel").css("display","inline");var e=map.getCenter();$("#latitude").html(e.lat.toFixed(4)),$("#longitude").html(e.lng.toFixed(4))})}),$(document).ready(function(){$("#evtTypeSelect").select2({placeholder:"All Types"}),$.ajax({dataType:"json",type:"GET",url:"http://stn.wim.usgs.gov/STNServices/eventtypes.json",headers:{Accept:"*/*"},success:function(e){e.sort(function(e,t){var s=e.TYPE,r=t.TYPE;return r>s?-1:s>r?1:0});for(var t=0;t<e.length;t++)$("#evtTypeSelect").append('<option value="'+e[t].event_type_id+'">'+e[t].type+"</option>"),fev.data.eventTypes.push(e[t])},error:function(e){console.log("Error processing the JSON. The error is:"+e)}}),$("#evtSelect").select2({placeholder:"All Events"}),$.ajax({dataType:"json",type:"GET",url:"http://stn.wim.usgs.gov/STNServices/events.json",headers:{Accept:"*/*"},success:function(e){e.sort(function(e,t){var s=e.event_name,r=t.event_name;return r>s?-1:s>r?1:0});for(var t=0;t<e.length;t++)$("#evtSelect").append('<option value="'+e[t].event_id+'">'+e[t].event_name+"</option>"),e[t].id=e[t].event_id,fev.data.events.push(e[t])},error:function(e){console.log("Error processing the JSON. The error is:"+e)}}),$("#stateSelect").select2({placeholder:"All Events"}),$.ajax({dataType:"json",type:"GET",url:"http://stn.wim.usgs.gov/STNServices/Sites/States.json",headers:{Accept:"*/*"},success:function(t){t.sort(function(e,t){var s=e.state_name,r=t.state_name;return r>s?-1:s>r?1:0});for(var s=0;s<t.length;s++)$("#stateSelect").append('<option value="'+t[s].state_abbrev+'">'+t[s].state_name+"</option>"),t[s].id=t[s],fev.data.states.push(t[s]);e()},error:function(e){console.log("Error processing the JSON. The error is:"+e)}}),$("#countySelect").select2({placeholder:"All Counties"}),$("#countySelect").on("select2:select select2:unselect",function(e){}),$("#sensorTypeSelect").select2({placeholder:"All Types"}),$.ajax({dataType:"json",type:"GET",url:"http://stn.wim.usgs.gov/STNServices/sensortypes.json",headers:{Accept:"*/*"},success:function(e){e.sort(function(e,t){var s=e.TYPE,r=t.TYPE;return r>s?-1:s>r?1:0});for(var t=0;t<e.length;t++)$("#sensorTypeSelect").append('<option value="'+e[t].sensor_type_id+'">'+e[t].sensor+"</option>"),fev.data.sensorTypes.push(e[t])},error:function(e){console.log("Error processing the JSON. The error is:"+e)}}),$("#sensorStatusSelect").select2({placeholder:"All Statuses"}),$.ajax({dataType:"json",type:"GET",url:"http://stn.wim.usgs.gov/STNServices/statustypes.json",headers:{Accept:"*/*"},success:function(e){for(var t=0;t<e.length;t++)$("#sensorStatusSelect").append('<option value="'+e[t].status_type_id+'">'+e[t].status+"</option>"),fev.data.sensorStatusTypes.push(e[t])},error:function(e){console.log("Error processing the JSON. The error is:"+e)}}),$("#collectionConditionSelect").select2({placeholder:"All Conditions"}),$.ajax({dataType:"json",type:"GET",url:"http://stn.wim.usgs.gov/STNServices/InstrCollectConditions.json",headers:{Accept:"*/*"},success:function(e){for(var t=0;t<e.length;t++)$("#collectionConditionSelect").append('<option value="'+e[t].id+'">'+e[t].condition+"</option>"),fev.data.collectionConditions.push(e[t])},error:function(e){console.log("Error processing the JSON. The error is:"+e)}}),$("#deployTypeSelect").select2({placeholder:"All Deploy Types"}),$.ajax({dataType:"json",type:"GET",url:"http://stn.wim.usgs.gov/STNServices/deploymenttypes.json",headers:{Accept:"*/*"},success:function(e){for(var t=0;t<e.length;t++)$("#deployTypeSelect").append('<option value="'+e[t].deployment_type_id+'">'+e[t].method+"</option>"),fev.data.deploymentTypes.push(e[t])},error:function(e){console.log("Error processing the JSON. The error is:"+e)}}),$("#hwmTypeSelect").select2({placeholder:"All Types"}),$.ajax({dataType:"json",type:"GET",url:"http://stn.wim.usgs.gov/STNServices/hwmtypes.json",headers:{Accept:"*/*"},success:function(e){for(var t=0;t<e.length;t++)$("#hwmTypeSelect").append('<option value="'+e[t].hwm_type_id+'">'+e[t].hwm_type+"</option>"),e[t].id=e[t].hwm_type_id,fev.data.hwmTypes.push(e[t])},error:function(e){console.log("Error processing the JSON. The error is:"+e)}}),$("#hwmQualitySelect").select2({placeholder:"All Qualities"}),$.ajax({dataType:"json",type:"GET",url:"http://stn.wim.usgs.gov/STNServices/hwmqualities.json",headers:{Accept:"*/*"},success:function(e){for(var t=0;t<e.length;t++)$("#hwmQualitySelect").append('<option value="'+e[t].hwm_quality_id+'">'+e[t].hwm_quality+"</option>"),e[t].id=e[t].hwm_quality_id,fev.data.hwmQualities.push(e[t])},error:function(e){console.log("Error processing the JSON. The error is:"+e)}});var e=function(){for(var e=0;e<fev.data.states.length;e++)$.ajax({dataType:"json",type:"GET",url:"http://stn.wim.usgs.gov/STNServices/Sites/CountiesByState.json?StateAbbrev="+fev.data.states[e].state_abbrev,headers:{Accept:"*/*"},currentState:fev.data.states[e].state_abbrev,success:function(e){fev.data.counties[this.currentState]=e},error:function(e){console.log("Error retrieving counties. The error is: "+e)}});setTimeout(function(){console.log(fev.data.counties)},300)};$("#evtTypeSelect").on("select2:select select2:unselect",function(e){var t=$(this).val();if(null!==t)if(t.length>0){for(var s=[],r=0;r<t.length;r++)s.push(Number(t[r]));var o=fev.data.events.filter(function(e){return s.indexOf(e.event_type_id)>-1});$("#evtSelect").html("");for(var a=0;a<o.length;a++)$("#evtSelect").append('<option value="'+o[a].event_id+'">'+o[a].event_name+"</option>")}else{$("#evtSelect").html("");for(var r=0;r<fev.data.events.length;r++)$("#evtSelect").append('<option value="'+fev.data.events[r].event_id+'">'+fev.data.events[r].event_name+"</option>")}}),$("#evtSelect").on("change",function(e){var t=$(this).val();if(t.length>0){for(var s=function(e){for(var t=[],s=0;s<e.length;s++)-1===t.indexOf(e[s])&&t.push(e[s]);return t},r=[],o=0;o<t.length;o++)r.push(parseInt(t[o]));for(var a=[],o=0;o<fev.data.events.length;o++)-1!==r.indexOf(fev.data.events[o].event_id)&&a.push(fev.data.events[o].event_type_id);for(var n=s(a),l=document.getElementById("evtTypeSelect").options,o=0;o<l.length;o++)l[o].disabled=!0,-1!==n.indexOf(parseInt(l[o].value))&&(l[o].disabled=!1)}else for(var i=document.getElementById("evtTypeSelect").options,o=0;o<i.length;o++)i[o].disabled=!1}),$("#stateSelect").on("select2:select select2:unselect",function(e){var t=$(this).val();if(!t>0||null===t)return $("#countySelect").html(""),void $("#countySelect").append("<option value=null>Please select state(s) first </option>");var s=[];for(var r in fev.data.counties)for(var o=0;o<fev.data.counties[r].length;o++){var a=fev.data.counties[r][o].county_name;t.indexOf(r)>-1&&(s=s.concat(a))}$("#countySelect").html("");for(var r in s){var n=s[r];$("#countySelect").append('<option value="'+n+'">'+n+"</option>")}})});var buildQueryStrings=function(){layerGroup.clearLayers(),oms.clearMarkers(),markerCoords=[];var e="";if(null!==$("#evtTypeSelect").val()){var t=$("#evtTypeSelect").val();e=t.toString(),$("#eventTypeDisplay").html($("#evtTypeSelect").select2("data").map(function(e){return e.text}).join(", "))}var s="";if(null!==$("#evtSelect").val()){var r=$("#evtSelect").val();s=r.toString(),$("#eventNameDisplay").html($("#evtSelect").select2("data").map(function(e){return e.text}).join(", "))}var o=[];$("#active")[0].checked&&!$("#complete")[0].checked&&(o.push(1),$("#eventStatusDisplay").html("Active")),$("#complete")[0].checked&&!$("#active")[0].checked&&(o.push(2),$("#eventStatusDisplay").html("Complete")),$("#active")[0].checked&&$("#complete")[0].checked&&(o.push(0),$("#eventStatusDisplay").html("Active, Complete")),$("#active")[0].checked||$("#complete")[0].checked||(o.push(0),$("#eventStatusDisplay").html(""));var a=o.toString(),n="";if(null!==$("#stateSelect").val()){var l=$("#stateSelect").val();n=l.toString(),$("#stateDisplay").html(n)}var i="";if(null!==$("#countySelect").val()){var c=$("#countySelect").val();i=c.toString(),$("#countyDisplay").html(i)}if($("#sensorRad")[0].checked){var u="";if(null!==$("#sensorTypeSelect").val()){var p=$("#sensorTypeSelect").val();u=p.toString(),$("#sensorTypeDisplay").html($("#sensorTypeSelect").select2("data")[0].text)}var d="";if(null!==$("#sensorStatusSelect").val()){var v=$("#sensorStatusSelect").val();d=v.toString(),$("#sensorStatusDisplay").html($("#sensorStatusSelect").select2("data")[0].text)}var h="";if(null!==$("#collectionConditionSelect").val()){var m=$("#collectionConditionSelect").val();h=m.toString(),$("#collectConditionDisplay").html($("#collectionConditionSelect").select2("data")[0].text)}var y="";if(null!==$("#deployTypeSelect").val()){var S=$("#deployTypeSelect").val();y=S.toString(),$("#deployTypeDisplay").html($("#deployTypeSelect").select2("data")[0].text)}fev.queryStrings.sensorsQueryString="?Event="+s+"&EventType="+e+"&EventStatus="+a+"&States="+n+"&County="+i+"&SensorType="+u+"&CurrentStatus="+d+"&CollectionCondition="+h+"&DeploymentType="+y,fev.urls.csvSensorsQueryURL=fev.urls.csvSensorsURLRoot+fev.queryStrings.sensorsQueryString,fev.urls.jsonSensorsQueryURL=fev.urls.jsonSensorsURLRoot+fev.queryStrings.sensorsQueryString,fev.urls.xmlSensorsQueryURL=fev.urls.xmlSensorsURLRoot+fev.queryStrings.sensorsQueryString,$("#sensorDownloadButtonCSV").attr("href",fev.urls.csvSensorsQueryURL),$("#sensorDownloadButtonJSON").attr("href",fev.urls.jsonSensorsQueryURL),$("#sensorDownloadButtonXML").attr("href",fev.urls.xmlSensorsQueryURL),$.each(["baro","met","rdg","stormTide","waveHeight"],function(e,t){displayGeoJSON(fev.urls[t+"GeoJSONViewURL"]+fev.queryStrings.sensorsQueryString,window[t+"MarkerIcon"])}),$(document).ajaxComplete(function(){markerCoords.length>0&&map.fitBounds(markerCoords)})}if($("#hwmRad")[0].checked){console.log("in HWM Radio listener function");var g="";if(null!==$("#hwmTypeSelect").val()){var f=$("#hwmTypeSelect").val();g=f.toString(),$("#hwmTypeDisplay").html($("#hwmTypeSelect").select2("data")[0].text)}var T="";if(null!==$("#hwmQualitySelect").val()){var w=$("#hwmQualitySelect").val();T=w.toString(),$("#hwmQualityDisplay").html($("#hwmQualitySelect").select2("data")[0].text)}var L=[];$("#coastal")[0].checked&&!$("#riverine")[0].checked&&(L.push("Coastal"),$("#hwmEnvDisplay").html("Coastal")),$("#riverine")[0].checked&&!$("#coastal")[0].checked&&(L.push("Riverine"),$("#hwmEnvDisplay").html("Riverine"));var b=L.toString(),k=[];$("#surveyCompleteYes")[0].checked&&!$("#surveyCompleteNo")[0].checked&&(k.push("true"),$("#hwmSurveyCompDisplay").html("True")),$("#surveyCompleteNo")[0].checked&&!$("#surveyCompleteYes")[0].checked&&(k.push("false"),$("#hwmSurveyCompDisplay").html("False"));var R=k.toString(),M=[];$("#stillWaterYes")[0].checked&&!$("#stillWaterNo")[0].checked&&(M.push("true"),$("#hwmStillWaterDisplay").html("True")),$("#stillWaterNo")[0].checked&&!$("#stillWaterYes")[0].checked&&(M.push("false"),$("#hwmStillWaterDisplay").html("False"));var N=M.toString();fev.queryStrings.hwmsQueryString="?Event="+s+"&EventType="+e+"&EventStatus="+a+"&States="+n+"&County="+i+"&HWMType="+g+"&HWMQuality="+T+"&HWMEnvironment="+b+"&SurveyComplete="+R+"&StillWater="+N,fev.urls.csvHWMsQueryURL=fev.urls.csvHWMsURLRoot+fev.queryStrings.hwmsQueryString,fev.urls.jsonHWMsQueryURL=fev.urls.jsonHWMsURLRoot+fev.queryStrings.hwmsQueryString,fev.urls.xmlHWMsQueryURL=fev.urls.xmlHWMsURLRoot+fev.queryStrings.hwmsQueryString,$("#hwmDownloadButtonCSV").attr("href",fev.urls.csvHWMsQueryURL),$("#hwmDownloadButtonJSON").attr("href",fev.urls.jsonHWMsQueryURL),$("#hwmDownloadButtonXML").attr("href",fev.urls.xmlHWMsQueryURL),displayGeoJSON(fev.urls.hwmFilteredGeoJSONViewURL+fev.queryStrings.hwmsQueryString,hwmMarkerIcon)}if($("#peakRad")[0].checked){var C;""!==$("#peakStartDate").value&&(C=$("#peakStartDate")[0].value);var U;""!==$("#peakEndDate").value&&(U=$("#peakEndDate")[0].value),fev.queryStrings.peaksQueryString="?Event="+s+"&EventType="+e+"&EventStatus="+a+"&States="+n+"&County="+i+"&StartDate="+C+"&EndDate="+U,fev.urls.csvPeaksQueryURL=fev.urls.csvPeaksURLRoot+fev.queryStrings.peaksQueryString,fev.urls.jsonPeaksQueryURL=fev.urls.jsonPeaksURLRoot+fev.queryStrings.peaksQueryString,fev.urls.xmlPeaksQueryURL=fev.urls.xmlPeaksURLRoot+fev.queryStrings.peaksQueryString,$("#peaksDownloadButtonCSV").attr("href",fev.urls.csvPeaksQueryURL),$("#peaksDownloadButtonJSON").attr("href",fev.urls.jsonPeaksQueryURL),$("#peaksDownloadButtonXML").attr("href",fev.urls.xmlPeaksQueryURL),displayGeoJSON(fev.urls.peaksGeoJSONViewURL+fev.queryStrings.peaksQueryString,peaksMarkerIcon)}};